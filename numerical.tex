\section{Numerical results} \label{res_numerical}
%
In order to test numerically the accuracy of our method, we use the following problem 
%
\begin{align*}
	\left\{\begin{array}{ll}
		\fl{s}{u} = 1, & x\in(-L,L)
		\\
		u\equiv 0, & x\in\RR\setminus(-L,L).
	\end{array}\right.
\end{align*}
%
In this particular case, the solution can be computed exactly and it is given in \cite{getoor1961first}. It reads as follows, 
\begin{align}\label{real_sol}
	u(x)=\frac{2^{-2s}\sqrt{\pi}}{\Gamma\left(\frac{1+2s}{2}\right)\Gamma(1+s)}\Big(L^2-x^2\Big)^s.
\end{align}

In figures \ref{smenos12} and \ref{smas12}, we show a comparison for different values of $s$ between the exact solution \eqref{real_sol} and the computed numerical approximation. Here we consider $L=1$ and $N=50$. One can notice that when $s=0.1$ (and also for other small values of s), the computed solution is to a certain extent different from the exact solution. However, one should be careful with such result and a more precise analysis of the error should be carried. 
%
\begin{figure}[!h]
	\pgfplotstableread{./figures/fl_01_50_sym.txt}{\datpu}
	\pgfplotstableread{./figures/fl_04_50_sym.txt}{\ddatpu}
		\subfloat[$s=0.1$]{
		\begin{tikzpicture}[scale=0.9]
		\begin{axis}[xmin=-1.1, xmax=1.1,legend style={at={(0.77,0.25)}}]
			\addplot [color=blue, mark=none,  thick] table[x=0,y=1]{\datpu};	
			\addplot [color=red, mark=x, only marks, thick] table[x=2,y=3]{\datpu};		
			\addlegendentry{Numerical solution}
			\addlegendentry{Real solution}
		\end{axis}
	\end{tikzpicture}
	\label{s01a}
	}
		\hspace{1cm}\subfloat[$s=0.4$]{
		\begin{tikzpicture}[scale=0.9]
		\begin{axis}[xmin=-1.1, xmax=1.1,legend style={at={(0.77,0.25)}}]
			\addplot [color=blue, mark=none, thick] table[x=0,y=1]{\ddatpu};	
			\addplot [color=red, mark=x, only marks, thick] table[x=2,y=3]{\ddatpu};		
			\addlegendentry{Numerical solution}
			\addlegendentry{Real solution}
		\end{axis}
	\end{tikzpicture}
	}
	\caption{Plot for different values of $s<1/2$}
	\label{smenos12}
\end{figure}

\begin{figure}[!h]
	\pgfplotstableread{./figures/fl_05_50_sym.txt}{\datpu}
	\pgfplotstableread{./figures/fl_08_50_sym.txt}{\ddatpu}
		\subfloat[$s=0.5$]{
		\begin{tikzpicture}[scale=0.9]
		\begin{axis}[xmin=-1.1, xmax=1.1,legend style={at={(0.77,0.25)}}]
			\addplot [color=blue, mark=none, thick] table[x=0,y=1]{\datpu};	
			\addplot [color=red, mark=x, only marks, thick] table[x=2,y=3]{\datpu};		
			\addlegendentry{Numerical solution}
			\addlegendentry{Real solution}
		\end{axis}
	\end{tikzpicture}
	}
		\hspace{1cm}\subfloat[$s=0.8$]{
		\begin{tikzpicture}[scale=0.9]
		\begin{axis}[xmin=-1.1, xmax=1.1,legend style={at={(0.77,0.25)}}]
			\addplot [color=blue, mark=none, thick] table[x=0,y=1]{\ddatpu};	
			\addplot [color=red, mark=x, only marks, thick] table[x=2,y=3]{\ddatpu};		
			\addlegendentry{Numerical solution}
			\addlegendentry{Real solution}
		\end{axis}
	\end{tikzpicture}
	}
	\caption{Plot for different values of $s\geq 1/2$}
	\label{smas12}
\end{figure}

In the same spirit as in \cite{acosta2017short}, the computation of the error in the space $H_0^s(-L,L)$ can be readily done by using the definition of the bilinear form, namely
%
\begin{align*}
\|u-u_h\|^2_{H_0^s(-L,L)}&=a(u-u_h,u-u_h) \\
&=a(u,u-u_h) \\
&=\int_{-L}^{L}f(x)\left(u(x)-u_h(x)\right)dx,
\end{align*}
%
where have used the orthogonality condition $a(v_h,u-u_h)=0$ $\forall v_h \in V_h$.

For this particular test, since $f\equiv 1$ in $(-L,L)$, the problem is therefore reduced to
%
\begin{align*}
\|u-u_h\|_{H^s_0(-L,L)}=\left(\int_{-L}^{L}\left( u(x)-u_h(x) \right)\,dx\right)^{1/2}
\end{align*}
%
where the right-hand side can be easily computed, since we have the closed formula 
%
\begin{align*}
\int_{-L}^{L}u\,dx= \frac{\pi L^{2s+1}}{2^{2s}\Gamma(s+\frac{1}{2})\Gamma(s+\frac{3}{2})}
\end{align*}
% 
and the term corresponding to $\int_{-L}^{L}u_h$ can be carried out numerically. 

In Figure \ref{error}, we present the computational errors evaluated for different values of $s$. These results are in accordance with the following result: 
%
\begin{theorem}[Theorem 4.6 of \cite{acosta2017short}]
%
For the solution $u$ of \eqref{WF} and its FE approximation $u_h$ given by \eqref{WFD}, if $h$ is sufficiently small, the following estimates hold
%
\begin{align*}
&\|u-u_h\|_{H^s_0(-L,L)}\leq C h^{1/2}|\!\ln h|\,\|f\|_{C^{1/2-s}(-L,L)}, \quad \textnormal{if}\quad s<1/2, \\
&\|u-u_h\|_{H^s_0(-L,L)}\leq C h^{1/2} |\!\ln h|\, \|f\|_{L^\infty(-L,L)}, \quad \textnormal{if}\quad  s=1/2 \\
&\|u-u_h\|_{H^s_0(-L,L)}\leq \tfrac{C}{2s-1} h^{1/2} \sqrt{|\!\ln h|}\, \|f\|_{C^\beta}(-L,L), \quad \textnormal{if} \quad s>1/2,
\end{align*}
%
where $C$ is a positive constant not depending on $h$. 
%
\end{theorem}

As expected, the rates of convergence shown in Figure \ref{error} are of order (in $h$) of 1/2. Indeed, since it is well-known that the notion of trace is not defined for the spaces $H^s(-L,L)$ with $s\leq 1/2$ (see \cite{lions1968problemes,tartar2007introduction}), a behavior as in Fig. \ref{s01a} is somehow natural, so we cannot expect a point-wise convergence. 

%
\begin{figure}
 \centering
  \pgfplotstableread{data_paper/result_convergence_01.org}{\datpu}
  \pgfplotstableread{data_paper/result_convergence_03.org}{\datpt}
   \pgfplotstableread{data_paper/result_convergence_05.org}{\datpcnum}
  \pgfplotstableread{data_paper/result_convergence_07.org}{\datps}
  \pgfplotstableread{data_paper/result_convergence_09.org}{\datpn}
   \pgfplotsset{
     legend cell align=left,
     legend pos=outer north east,
     legend plot pos=right,
     legend style={cells={anchor=east},draw=none},
     }
%
  %\subfloat[Convergence of the error]{\label{fig_case_O_subset_omega}
  \begin{tikzpicture}%[scale=1] 
  \label{conv}
  \begin{loglogaxis}[xlabel=$h$, ymax=2e-1]
  	%\addplot [color=blue, very thick] table [x=0, y=2] {\datpt};
	\addplot [color=black, mark=o, thick] table [x=0, y=1] {\datpu};
	\addlegendentry{$s=0.1$};
	\addplot [color=black, mark=diamond, mark size=3 pt, thick] table [x=0, y=1] {\datpt};
	\addlegendentry{${s}=0.3$};
	\addplot [color=black, mark=pentagon, thick] table [x=0, y=1] {\datpcnum};
	\addlegendentry{${s}=0.5$};
	\addplot [color=black, mark=square, thick] table [x=0, y=1] {\datps};
	\addlegendentry{$ s=0.7$};
	\addplot [color=black, mark=triangle, mark size=3 pt, thick] table [x=0, y=1] {\datpn};
	\addlegendentry{$ s=0.9$};
%
 \draw [pente]  (axis cs: 0.0008,4e-2) -- ++ (axis cs: 1, {10^(0.5)}) -- ++ (axis cs: 10, 1) -- cycle;
 \node at (axis cs:0.0008,10e-2) [right,pente] {\small slope $0.5$};
%
  \end{loglogaxis}
\end{tikzpicture}%
\caption{Convergence of the error.}
\label{error}
\end{figure}



\begin{figure}
 \centering
  \pgfplotstableread{data_paper/result_convergence_01.org}{\datpu}
  \pgfplotstableread{data_paper/result_convergence_03.org}{\datpt}
   \pgfplotstableread{data_paper/result_convergence_05.org}{\datpcnum}
  \pgfplotstableread{data_paper/result_convergence_07.org}{\datps}
  \pgfplotstableread{data_paper/result_convergence_09.org}{\datpn}
   \pgfplotsset{

     legend cell align=left,
     legend pos=outer north east,
     legend plot pos=right,
     legend style={cells={anchor=east},draw=none},
     }

%
  %\subfloat[Convergence of the error]{\label{fig_case_O_subset_omega}
  \begin{tikzpicture}%[scale=1] 
  \label{conv}
  \begin{loglogaxis}[xlabel=$h$, ymax=2e-1]
  	%\addplot [color=blue, very thick] table [x=0, y=2] {\datpt};
	\addplot [color=black, mark=o, thick] table [x=0, y=1] {\datpu};
	\addlegendentry{$s=0.1$};
	\addplot [color=black, mark=diamond, mark size=3 pt, thick] table [x=0, y=1] {\datpt};
	\addlegendentry{${s}=0.3$};
	\addplot [color=black, mark=pentagon, thick] table [x=0, y=1] {\datpcnum};
	\addlegendentry{${s}=0.5$};
	\addplot [color=black, mark=square, thick] table [x=0, y=1] {\datps};
	\addlegendentry{$ s=0.7$};
	\addplot [color=black, mark=triangle, mark size=3 pt, thick] table [x=0, y=1] {\datpn};
	\addlegendentry{$ s=0.9$};
%
 \draw [pente]  (axis cs: 0.0008,4e-2) -- ++ (axis cs: 1, {10^(0.5)}) -- ++ (axis cs: 10, 1) -- cycle;
 \node at (axis cs:0.0008,10e-2) [right,pente] {\small slope $0.5$};
%
  \end{loglogaxis}
\end{tikzpicture}%
\caption{Convergence of the error.}
\label{error}
\end{figure}


\subsection{Control experiments}
%
To address the actual computation of fully-discrete controls for a given problem, we use the methodology described, for instance, in \cite{}, and apply an optimisation algorithm to the dual functional \eqref{dual_fully}. Since these functionals are quadratic and coercive, the conjugate gradient is a natural choice and the computation of the gradient amounts to solve first the homogeneous equation 
%
\begin{align}
	\begin{cases}
		\displaystyle\mathcal M_h \frac{\varphi^n-\varphi^{n+1}}{\delta t}+\mathcal A_h \varphi^n=0, & \forall n\in\inter{1,M}
		\\
		\varphi^{M+1}=\varphi^T. 
	\end{cases}
\end{align}
%
Then, set $v^n=\mathbf{1}_\omega\varphi^n$ and finally solve 
%
\begin{align}\label{frac_heat_num}
	\begin{cases}
		\displaystyle\mathcal M_h \frac{z^{n+1}-z^n}{\delta t}+\mathcal A_h z^{n+1}=\mathbf{1}_\omega \varphi_h^{n+1}, \quad \forall n\in \left\{1,\ldots,M-1\right\}
		\\
		z^0=0. 
	\end{cases}
\end{align}
%

\begin{figure}
 \centering
  \pgfplotstableread{data_paper/res.org}{\datpu}
     \pgfplotsset{
 legend cell align=left,
     legend pos=outer north east,
     legend plot pos=right,
     legend style={cells={anchor=east},draw=none},
     }

  %\subfloat[Convergence of the error]{\label{fig_case_O_subset_omega}
  \begin{tikzpicture}%[scale=1] 
  \label{conv}
  \begin{loglogaxis}%[xlabel=$h$, ymax=2e-1]
  	%\addplot [color=blue, very thick] table [x=0, y=2] {\datpt};
	\addplot [color=black, mark=o, thick] table [x=0, y=1] {\datpu};
%
 \draw [pente]  (axis cs: 0.001,0.8) -- ++ (axis cs: 1, {5^(0.1)}) -- ++ (axis cs: 5, 1) -- cycle;
 \node at (axis cs:0.001,0.8) [right,pente] {\small slope $0.1$};
%
  \end{loglogaxis}
\end{tikzpicture}%
\caption{Convergence of the error.}
\label{error}
\end{figure}

\subsection{Numerical experiments}

%\begin{figure}[ht]
%%%  Datos del experimento 
%%%  T=0.3, epsilon=0.01*h, s=0.8
% \centering
%% 
%\subfloat[The adjoint][Uncontrolled solution]{
%\begin{tikzpicture}
%\begin{axis}[surface,zmax=1.0]
%  
%\addplot3 [mesh/ordering=y varies, surf, shader=flat,draw=black,opacity=0.6] file {./data_paper/soly_s08_sc.dat};
%\node at (axis cs:0.34,0,0) [below] {$T=0.3$};
%
%\end{axis}
%\end{tikzpicture}}
%%
%\hspace{1 cm}
%  \subfloat[The state][Controlled solution ({\tikz \fill [green] (0,0) rectangle (0.2,0.2);}=control domain)]{
%\begin{tikzpicture}
%\begin{axis}[surface, zmax=1.0]
%
%  %\controldomainT{-0.3}{0.8}{0.3};
%  \couplingdomainT{-0.3}{0.8}{0.3};
%  
%\addplot3 [mesh/ordering=y varies, surf, shader=flat,draw=black,opacity=0.6] file {./data_paper/soly_s08_cc.dat};
%\node at (axis cs:0.34,0,0) [below] {$T=0.3$};
%
%\end{axis}
%\end{tikzpicture}}%
%\caption{Time evolution of system \eqref{}.}\label{fig_heat_frac}
%\end{figure}



\begin{figure}
  \centering
\begin{tikzpicture}
  \begin{loglogaxis}[erreurs, ymin=5e-4,ymax=0.2e1,title={$s=0.8$}]
 
    \pgfplotstableread[ignore chars={|},skip first n=2]{data_paper/heat_frac_s=08.org}\resultats
    %% Original file  resultats_09-06-2017_11h18.org

    \addplot[cout] table[x=dx,y=Nv] \resultats;
    \addlegendentry{Cost of the control};
    \addplot[cible] table[x=dx,y=NyT] \resultats;
    \addlegendentry{Size of $y^M$};
    \addplot[energie] table[x=dx,y=Inf_eps(F_eps)] \resultats;
    \addlegendentry{Optimal energy};
    \draw [pente]  (axis cs: 0.003,84e-4) -- ++ (axis cs: 1, 10^0.5) -- ++ (axis cs: 10, 1) -- cycle;
    \node at (axis cs:0.003,20e-3) [right,pente] {\small slope $0.5$};
    
  \end{loglogaxis}
  
\end{tikzpicture}
\caption{Convergence properties of the method for controllability of the fractional heat equation. }\label{figure_case1}
\end{figure}

 \begin{figure}
 \centering
 \begin{tikzpicture}
  \begin{loglogaxis}[erreurs, ymin=4e-2,ymax=40.4e1,title={$s=0.4$}]
 
    \pgfplotstableread[ignore chars={|},skip first n=2]{data_paper/heat_frac_s=04.org}\resultats
    %% Original file  resultats_09-06-2017_11h47.org

    \addplot[cout] table[x=dx,y=Nv] \resultats;
    %\addlegendentry{Cost of the control};
    \addplot[cible] table[x=dx,y=NyT] \resultats;
    %\addlegendentry{Size of $y^M$};
    \addplot[energie] table[x=dx,y=Inf_eps(F_eps)] \resultats;
    %\addlegendentry{Optimal energy};
    \draw [pente]  (axis cs: 0.003,1.2e-1) -- ++ (axis cs: 1, 10^0.35) -- ++ (axis cs: 10, 1) -- cycle;
    \node at (axis cs:0.003,20e-2) [right,pente] {\small slope $0.35$};
    
    \draw [pente]  (axis cs: 0.003,80.4e0) -- ++ (axis cs: 1, {10^(-0.4)}) -- ++ (axis cs: 10, 1) -- cycle;
    \draw [pente]  (axis cs: 0.003,56.7e0) -- ++ (axis cs: 1, {10^(-0.25)}) -- ++ (axis cs: 10, 1) -- cycle;
    \node at (axis cs:0.003,23e0) [right,pente] {\small sl. $-0.25/-0.4$};
    
  \end{loglogaxis}
  
\end{tikzpicture}
\caption{Convergence properties of the method for controllability of the fractional heat equation. }\label{figure_case1}
\end{figure}

 \begin{figure}
 \centering
 \begin{tikzpicture}
  \begin{loglogaxis}[erreurs, ymin=3e-2,ymax=10e1,title={$s=0.5$}]
 
    \pgfplotstableread[ignore chars={|},skip first n=2]{data_paper/heat_frac_s=05.org}\resultats
    %% Original file  resultats_09-06-2017_11h07.org

    \addplot[cout] table[x=dx,y=Nv] \resultats;
    %\addlegendentry{Cost of the control};
    \addplot[cible] table[x=dx,y=NyT] \resultats;
    %\addlegendentry{Size of $y^M$};
    \addplot[energie] table[x=dx,y=Inf_eps(F_eps)] \resultats;
    %\addlegendentry{Optimal energy};
    \draw [pente]  (axis cs: 0.003,10e-2) -- ++ (axis cs: 1, 10^0.4) -- ++ (axis cs: 10, 1) -- cycle;
    \node at (axis cs:0.003,18e-2) [right,pente] {\small slope $0.4$};
    
    \draw [pente]  (axis cs: 0.003,2.65e1) -- ++ (axis cs: 1, {10^(-0.18)}) -- ++ (axis cs: 10, 1) -- cycle;
    \draw [pente]  (axis cs: 0.003,3.5e1) -- ++ (axis cs: 1, {10^(-0.3)}) -- ++ (axis cs: 10, 1) -- cycle;
    \node at (axis cs:0.003,1.35e1) [right,pente] {\small sl. $-0.18/-0.3$};
    
  \end{loglogaxis}
  
\end{tikzpicture}
\caption{Convergence properties of the method for controllability of the fractional heat equation. }\label{figure_case1}
\end{figure}