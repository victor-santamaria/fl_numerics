\section{Finite element approximation}\label{fe_sec}

\subsection{Elliptic problem}

In order to solve numerically \eqref{PE}, we will develop a finite element scheme on a uniform mesh. To this purpose, let us firstly recall the variational formulation associated to our problem: find $u\in H_0^s(-L,L)$ such that
\begin{align}\label{WF}
	\frac{\ccs}{2} \int_{\RR}\int_{\RR}\frac{(u(x)-u(y))(v(x)-v(y))}{|x-y|^{1+2s}}\,dxdy = \int_{-L}^L fv\,dx,	
\end{align}
for all $v\in H_0^s(-L,L)$. 

Now, let us now introduce a partition of the interval $(-L,L)$ as follows:
\begin{align*}
	-L = x_0<x_1<\ldots <x_i<x_{i+1}<\ldots<x_{N+1}=L\,,
\end{align*}
with $x_{i+1}=x_i+h$, $i=0,\ldots N$. We call $\mathfrak{M}$ the mesh composed by the points $\{x_i\,:\, i=1,\ldots,N\}$, while the set of the boundary points is denoted $\partial\mathfrak{M}:=\{x_0,x_{N+1}\}$. Define $K_i:=[x_i,x_{i+1}]$ and consider the discrete space 
\begin{align*}
	V_h :=\Big\{v\in H_0^s(-L,L)\,\big|\, \left. v\,\right|_{K_i}\in \mathcal{P}^1\Big\},
\end{align*} 
where $\mathcal{P}^1$ is the space of the continuous and piecewise linear functions. Hence, we approximate \eqref{WF} with the following discrete problem: find $u_h\in V_h$ such that
\begin{align}\label{WFD}
	\frac{\ccs}{2} \int_{\RR}\int_{\RR}\frac{(u_h(x)-u_h(y))(v_h(x)-v_h(y))}{|x-y|^{1+2s}}\,dxdy = \int_{-L}^L fv_h\,dx,	
\end{align}
for all $v_h\in V_h$. If now we indicate with $\big\{\phi_i\big\}_{i=1}^N$ a basis of $V_h$, it will be sufficient that \eqref{WFD} is satisfied for all the functions of the basis, since any element of $V_h$ is a linear combination of them. We therefore rewrite 
\begin{align*}
	u_h(x) = \sum_{i=1}^N u_i\phi_i(x),\;\;\; v_h(x) = \sum_{i=1}^N v_i\phi_i(x),
\end{align*} 
and \eqref{WFD} is reduced to solve the linear system $\mathcal A_h u=F$, where the stiffness matrix $\mathcal A_h\in \RR^{N\times N}$ has components
\begin{align}\label{stiffness}
	a_{i,j}=\frac{\ccs}{2} \int_{\RR}\int_{\RR}\frac{(\phi_i(x)-\phi_i(y))(\phi_j(x)-\phi_j(y))}{|x-y|^{1+2s}}\,dxdy,	
\end{align}
while the vector $F\in\RR^N$ is given by $F=(F_1,\ldots,F_N)$ with
\begin{align*}
	F_i = \int_{-L}^L f\phi_i\,dx,\;\;\; i=1,\ldots,N.
\end{align*}

Moreover, the basis $\big\{\phi_i\big\}_{i=1}^N$ that we will employ is the classical one in which each $\phi_i$ is the tent function such that $supp(\phi_i)=(x_{i-1},x_{i+1})$ and $\phi_i(x_j)=\delta_{i,j}$. In particular, for $x\in\{x_{i-1},x_i,x_{i+1}\}$ the $i^{th}$ function of the basis is explicitly defined as (see Figure \ref{basis}) 
\begin{align}\label{basis_fun}
	\phi_i(x)= 1-\frac{|x-x_i|}{h}.
\end{align} 

\begin{figure}[h]
\figinit{0.8pt}
% Axes
\figpt 1:(-100,0) \figpt 2:(200,0)
\figpt 11:(-90,-10) \figpt 12:(-90,140)
%%%%
\figpt 3:(-50,0) \figpt 4:(0,100) 
\figpt 5:(50,0) \figpt 6:(0,0)
%
% Points for writing
\figpt 7:(-50,-10) \figpt 8:(0,110) 
\figpt 9:(50,-10) \figpt 10:(0,-10)

\figpt 13:(-100,130) \figpt 14:(180,-10)
\figpt 15:(50,50)

% 2. Creation of the graphical file
\figdrawbegin{}
\figdrawarrow[1,2]
\figdrawline[3,4]
\figdrawline[4,5]
\figset(dash=4)
\figdrawline[4,6]
\figdrawarrow[11,12]

\figdrawend

% 3. Writing text on the figure
\figvisu{\figBoxA}{}{
\figwritec [7]{$(x_{i-1},0)$}
\figwritec [8]{$(x_i,1)$}
\figwritec [9]{$(x_{i+1},0)$}
\figwritec [10]{$(x_i,0)$}
\figwritec [13]{$y$}
\figwritec [14]{$x$}
\figwritec [15]{$\phi_i(x)$}
}
\centerline{\box\figBoxA}
\caption{Basis function $\phi_i(x)$ on its support $(x_{i-1},x_{i+1})$.}\label{basis}
\end{figure}
\noindent Let us now describe our algorithm. Before that, we shall make the following preliminary comments.
\begin{remark}\label{rem_prel}
The following fact are worth noticing.
\begin{itemize}
	\item It is evident from the definition \eqref{stiffness} that $\mathcal A_h$ is symmetric. Therefore, in our algorithm we will only need to compute the values $a_{i,j}$ with $j\geq i$.
	
	\item Due to the non-local nature of the problem, the matrix $\mathcal A_h$ is full. However, while computing its components we will encounter many simplifications, due to the fact that $supp(\phi_i)\cap supp(\phi_j) =\emptyset$ for $j\geq i+2$.
	
	\item With some abuse of notation, let us define 
	\begin{align}\label{stiffness_nc}
	a_{i,j}= \int_{\RR}\int_{\RR}\frac{(\phi_i(x)-\phi_i(y))(\phi_j(x)-\phi_j(y))}{|x-y|^{1+2s}}\,dxdy.
\end{align}
	In other words, while calculating the components $a_{i,j}$ we will not consider the multiplicative constant $\ccs/2$, since it is uniform for all the elements of the matrix. 
	
	\item While computing the values $a_{i,j}$, we will only work on the mesh $\mathfrak{M}$, not considering the points of the set $\partial\mathfrak{M}$. In this way, we will ensure that the basis functions $\phi_i$ satisfy the zero Dirichlet boundary conditions. In other words, in our FE approximation we are considering only the functions from $\phi_1$ to $\phi_N$. By considering, instead, also the points $x_0$ and $x_{N+1}$, then we would introduce in our discretization also the basis functions $\phi_0$ and $\phi_{N+1}$, which take value $1$ at the boundary, and this would not be consistent with the continuous problem. Figure \ref{basis_int} provides a graphical explanation of this last discussion.      	
\end{itemize}
\end{remark}

\begin{figure}[h]
\figinit{0.8pt}
% Axes
\figpt 1:(-110,0) \figpt 2:(420,0)
\figpt 11:(-100,-10) \figpt 12:(-100,140)
%%%%
\figpt 3:(-75,0) \figpt 4:(-25,100) 
\figpt 5:(25,0) \figpt 6:(-25,0)

\figpt 31:(-25,0) \figpt 41:(25,100) 
\figpt 51:(75,0) \figpt 61:(25,0)

\figpt 32:(25,0) \figpt 42:(75,100) 
\figpt 52:(125,0) \figpt 62:(75,0)

\figpt 33:(265,0) \figpt 43:(315,100) 
\figpt 53:(365,0) \figpt 63:(315,0)

\figpt 200:(-100,100)
%
% Points for writing
\figpt 7:(-75,-10) \figpt 8:(-25,110) 
\figpt 9:(25,-10) \figpt 10:(-25,-10)

\figpt 71:(-25,-10) \figpt 81:(25,110) 
\figpt 91:(75,-10) \figpt 101:(25,-10)

\figpt 72:(25,-10) \figpt 82:(75,110) 
\figpt 92:(125,-10) \figpt 102:(75,-10)

\figpt 73:(265,-10) \figpt 83:(315,110) 
\figpt 93:(365,-10) \figpt 103:(315,-10)

\figpt 13:(-110,130) \figpt 14:(405,-10)
\figpt 15:(50,50) \figpt 16:(250,50)

\figpt 201:(-110,100) \figpt 202:(200,50)

% 2. Creation of the graphical file
\figdrawbegin{}
\figdrawarrow[1,2]
\figdrawline[3,4]
\figdrawline[4,5]
\figset (color=\Redrgb)
\figdrawline[31,41]
\figdrawline[41,51]
\figset (color=default)
\figset (color=\ForestGreenrgb)
\figdrawline[32,42]
\figdrawline[42,52]
\figset (color=default)
\figset (color=\Bluergb)
\figdrawline[33,43]
\figdrawline[43,53]
\figset (color=default)
\figset(dash=4)
\figdrawline[4,6]
\figdrawline[200,4]
\figdrawline[41,61]
\figdrawline[42,62]
\figdrawline[43,63]
\figdrawarrow[11,12]

\figdrawend

% 3. Writing text on the figure
\figvisu{\figBoxA}{}{
\figwritec [7]{$x_0=-L$}
\figwritec [8]{$\phi_1$}
\figwritec [9]{$x_2$}
\figwritec [10]{$x_1$}
\figwritec [81]{$\phi_2$}
\figwritec [91]{$x_3$}
\figwritec [82]{$\phi_3$}
\figwritec [92]{$x_4$}
\figwritec [73]{$x_{N-1}$}
\figwritec [83]{$\phi_N$}
\figwritec [93]{$x_{N+1}=L$}
\figwritec [103]{$x_N$}
\figwritec [13]{$y$}
\figwritec [14]{$x$}
\figwritec [201]{$1$}
\figwritec [202]{$\ldots\ldots\ldots$}
\figwritec[3,53]{$\bullet$}
%\figwritec [7,93]
%\figwritec [15]{$\phi_i(x)$}
%\figwritec [16]{$\color{red}\phi_j(x)$}
}
\centerline{\box\figBoxA}
\caption{Basis functions $\phi_i(x)$ on the whole interval $(-L,L)$.}\label{basis_int}
\end{figure}

We now start building the stiffness matrix $\mathcal A_h$. This will be done it in three steps, since the values of the matrix can be computed differentiating among three well defined regions: the upper triangle ($j\geq i+2$), the upper diagonal ($j=i+1$) and the diagonal ($j=i$). This because, as it will be clear during our computations, in each of these regions the intersections among the support of the basis functions are different, thus generating different values of the bilinear form. In what follows, we will briefly present which will be the contributions to the matrix in each of these three steps, including the complete computations as an appendix at the end of the paper. 
%\begin{tikzpicture}
% \matrix[matrix of math nodes,left delimiter = (,right delimiter = ),row sep=10pt,column sep = 10pt] (m)
% {
% a_{1,1}  & a_{1,2} & a_{1,3} & \ldots\ldots & \ldots\ldots & a_{1,N}\\
%   &a_{2,2} & a_{2,3} & a_{2,4} & \ldots\ldots &a_{2,N}\\
%   & & & & \ddots &\vdots\\
%   & & & & \ldots\ldots &a_{N-2,N}\\	   
%   & & & & a_{N-1,N-1} &a_{N-1,N}\\
%   & & & & & a_{N,N}\\
% };
%\begin{pgfonlayer}{background}
% \node[inner sep=3pt,fit=(m-1-3)]          (1)   {};
% \node[inner sep=3pt,fit=(m-1-4) (m-2-5)]  (2)   {};
% \node[inner sep=3pt,fit=(m-3-6)]          (3)   {};
%
%
%% \node[inner sep=3pt,fit=(m-2-4) (m-2-6)]  (3)   {};
%% \node[inner sep=3pt,fit=(m-3-5) (m-3-6)]  (4)   {};
%%  \node[inner sep=3pt,fit=(m-5-6)]         (5)   {};
%\draw[rounded corners,dotted,fill=green!50!white,inner sep=3pt,fill opacity=0.1] (1.north 
%west) -- (2.north east) |- (3.south west) |- (2.south west) |- (1.south west) -- cycle;
%%\draw[rounded corners,dotted,fill=green!50!white,inner sep=3pt,fill opacity=0.1] (1.north west) -- (2.north east) |- (5.south east)--cycle; |- (4.north east)--cycle;% |- (5.north east) |- (2.north) --cycle;
%%\draw[rounded corners,dotted,fill=green!50!white,inner sep=3pt,fill opacity=0.1] (1.north west) -- (2.north east) |- (3.south west) |- (3.north east) |- (4.north west) |- (4.north east) --cycle;% |- (1.south west) -- cycle;
%%\draw[rounded corners,dotted,fill=green!50!white,inner sep=3pt,fill opacity=0.1] (1.north west) -- (2.north east) |- (3.south west) |- (3.north east) |- (4.north west) |- (4.north east) --cycle;% |- (1.south west) -- cycle;
%\end{pgfonlayer}
%\end{tikzpicture}

\subsubsection*{Step 1: $j\geq i+2$}
As we were mentioned in Remark \ref{rem_prel} before, in this case we have $supp(\phi_i)\cap supp(\phi_j) =\emptyset$ (see also Figure \ref{basis_upp_tri}). Hence, \eqref{stiffness_nc} is reduced to computing only the integral
\begin{align}\label{elem_noint}
	a_{i,j}=-2 \int_{x_{j-1}}^{x_{j+1}}\int_{x_{i-1}}^{x_{i+1}}\frac{\phi_i(x)\phi_j(y)}{|x-y|^{1+2s}}\,dxdy.
\end{align}

\begin{figure}[h]
\figinit{0.8pt}
% Axes
\figpt 1:(-100,0) \figpt 2:(320,0)
\figpt 11:(-90,-10) \figpt 12:(-90,140)
%%%%
\figpt 3:(-50,0) \figpt 4:(0,100) 
\figpt 5:(50,0) \figpt 6:(0,0)

\figpt 31:(150,0) \figpt 41:(200,100) 
\figpt 51:(250,0) \figpt 61:(200,0)
%
% Points for writing
\figpt 7:(-50,-10) \figpt 8:(0,110) 
\figpt 9:(50,-10) \figpt 10:(0,-10)

\figpt 71:(150,-10) \figpt 81:(200,110) 
\figpt 91:(250,-10) \figpt 101:(200,-10)

\figpt 13:(-100,130) \figpt 14:(300,-10)
\figpt 15:(50,50) \figpt 16:(250,50)

% 2. Creation of the graphical file
\figdrawbegin{}
\figdrawarrow[1,2]
\figdrawline[3,4]
\figdrawline[4,5]
\figset (color=\Redrgb)
\figdrawline[31,41]
\figdrawline[41,51]
\figset (color=default)
\figset(dash=4)
\figdrawline[4,6]
\figdrawline[41,61]
\figdrawarrow[11,12]

\figdrawend

% 3. Writing text on the figure
\figvisu{\figBoxA}{}{
\figwritec [7]{$(x_{i-1},0)$}
\figwritec [8]{$(x_i,1)$}
\figwritec [9]{$(x_{i+1},0)$}
\figwritec [10]{$(x_i,0)$}
\figwritec [71]{$(x_{j-1},0)$}
\figwritec [81]{$(x_j,1)$}
\figwritec [91]{$(x_{j+1},0)$}
\figwritec [101]{$(x_j,0)$}
\figwritec [13]{$y$}
\figwritec [14]{$x$}
\figwritec [15]{$\phi_i(x)$}
\figwritec [16]{$\color{red}\phi_j(x)$}
}
\centerline{\box\figBoxA}
\caption{Basis functions $\phi_i(x)$ and $\phi_j(x)$ for $j\geq i+1$. In this case, the supports are disjoint.}\label{basis_upp_tri}
\end{figure}

Taking into account the definition of the basis function \eqref{basis_fun}, from \eqref{elem_noint} we obtain
\begin{align*}
	a_{i,j}=-2 \int_{x_{j-1}}^{x_{j+1}}\int_{x_{i-1}}^{x_{i+1}}\frac{\left(1-\frac{|x-x_i|}{h}\right)\left(1-\frac{|y-x_j|}{h}\right)}{|x-y|^{1+2s}}\,dxdy.
\end{align*}

Finally, this last integral can be computed explicitly employing the following  change of variables:
\begin{align}\label{cv}
	\frac{x-x_i}{h}=\hat{x},\;\;\; \frac{y-x_i}{h}=\hat{y}.
\end{align}
In this way, for the elements $a_{i,j}$, $j\geq i+2$, we get the following values: 
\begin{align*}
	a_{i,j} = \begin{cases}
			\displaystyle -h^{1-2s}\,\frac{4(j-i+1)^{3-2s} + 4(j-i-1)^{3-2s}-6(j-i)^{3-2s}-(j-i+2)^{3-2s}-(j-i-2)^{3-2s}}{2s(1-2s)(1-s)(3-2s)} & \displaystyle s\neq\frac{1}{2} 
			\\
			\\
			-4(j-i+1)^2\log(j-i+1)-4(j-i-1)^2\log(j-i-1) &  \displaystyle s=\frac{1}{2}
			\\
			\;\;\;+6(j-i)^2\log(j-i)+(j-i+2)^2\log(j-i+2)+(j-i-2)^2\log(j-i-2), &  \displaystyle j> i+2
			\\
			\\
			56\ln(2)-36\ln(3) & \displaystyle s=\frac{1}{2}
			\\
			& \displaystyle j= i+2.
		\end{cases}	
\end{align*}

\subsubsection*{Step 2: $j= i+1$}
This is the most cumbersome case, since it is the one with the most interactions between the basis functions (see Figure \ref{basis_upp_dia}). 

\begin{figure}[h]
\figinit{0.8pt}
% Axes
\figpt 1:(-100,0) \figpt 2:(200,0)
\figpt 11:(-90,-10) \figpt 12:(-90,140)
%%%%
\figpt 3:(-50,0) \figpt 4:(0,100) 
\figpt 5:(50,0) \figpt 6:(0,0)

\figpt 31:(0,0) \figpt 41:(50,100) 
\figpt 51:(100,0) \figpt 61:(50,0)
%
% Points for writing
\figpt 7:(-50,-10) \figpt 8:(0,110) 
\figpt 9:(50,-10) \figpt 10:(0,-10)

\figpt 71:(0,-25) \figpt 81:(50,110) 
\figpt 91:(100,-25) \figpt 101:(50,-25)

\figpt 13:(-100,130) \figpt 14:(180,-10)
\figpt 15:(-50,50) \figpt 16:(100,50)

% 2. Creation of the graphical file
\figdrawbegin{}
\figdrawarrow[1,2]
\figdrawline[3,4]
\figdrawline[4,5]
\figset (color=\Redrgb)
\figdrawline[31,41]
\figdrawline[41,51]
\figset (color=default)
\figset(dash=4)
\figdrawline[4,6]
\figdrawline[41,61]
\figdrawarrow[11,12]

\figdrawend

% 3. Writing text on the figure
\figvisu{\figBoxA}{}{
\figwritec [7]{$(x_{i-1},0)$}
\figwritec [8]{$(x_i,1)$}
\figwritec [9]{$(x_{i+1},0)$}
\figwritec [10]{$(x_i,0)$}
\figwritec [71]{$(x_{j-1},0)$}
\figwritec [81]{$(x_j,1)$}
\figwritec [91]{$(x_{j+1},0)$}
\figwritec [101]{$(x_j,0)$}
\figwritec [13]{$y$}
\figwritec [14]{$x$}
\figwritec [15]{$\phi_i(x)$}
\figwritec [16]{$\color{red}\phi_j(x)$}
}
\centerline{\box\figBoxA}
\caption{Basis functions $\phi_i(x)$ and $\phi_{i+1}(x)$. In this case, the intersection of the supports is the interval $[x_i,x_{i+1}]$.}\label{basis_upp_dia}
\end{figure}

According to \eqref{stiffness_nc}, and using the symmetry of the integral with respect to the bisector $y=x$, we have 
	\begin{align*}
	a_{i,i+1}= & \int_{\RR}\int_{\RR}\frac{(\phi_i(x)-\phi_i(y))(\phi_{i+1}(x)-\phi_{i+1}(y))}{|x-y|^{1+2s}}\,dxdy
	\\
	= & \int_{x_{i+1}}^{+\infty}\int_{x_{i+1}}^{+\infty} \ldots\,dxdy + 2\int_{x_{i+1}}^{+\infty}\int_{x_i}^{x_{i+1}} \ldots\,dxdy + 2\int_{x_{i+1}}^{+\infty}\int_{-\infty}^{x_i} \ldots\,dxdy 
	\\
	& + \int_{x_i}^{x_{i+1}}\int_{x_i}^{x_{i+1}} \ldots\,dxdy + 2\int_{x_i}^{x_{i+1}}\int_{-\infty}^{x_i} \ldots\,dxdy + \int_{-\infty}^{x_i}\int_{-\infty}^{x_i} \ldots\,dxdy 
	\\
	:= & Q_1 + Q_2 + Q_3 + Q_4 + Q_5 + Q_6.
\end{align*}

These contributions will be calculated separately, employing change of variables analogous to \eqref{cv}. After several computations, we will obtain
\begin{align}\label{Aii1}
	a_{i,i+1} = \begin{cases}
					\displaystyle h^{1-2s}\frac{3^{3-2s}-2^{5-2s}+7}{2s(1-2s)(1-s)(3-2s)}, & \displaystyle s\neq \frac{1}{2}
					\\
					9\ln 3-16\ln 2, & \displaystyle s=\frac{1}{2}.
				\end{cases}	
\end{align}

\subsubsection*{Step 3: $j= i$}
As a last step, we fill the diagonal of the matrix $\mathcal A_h$. In this case we have
	\begin{align*}
	a_{i,i}= & \int_{\RR}\int_{\RR}\frac{(\phi_i(x)-\phi_i(y))^2}{|x-y|^{1+2s}}\,dxdy
	\\
	= & \int_{x_{i+1}}^{+\infty}\int_{x_{i+1}}^{+\infty} \ldots\,dxdy + 2\int_{x_{i+1}}^{+\infty}\int_{x_{i-1}}^{x_{i+1}} \ldots\,dxdy + \int_{x_{i+1}}^{+\infty}\int_{-\infty}^{x_{i-1}} \ldots\,dxdy 
	\\
	& + \int_{x_{i-1}}^{x_{i+1}}\int_{x_{i-1}}^{x_{i+1}} \ldots\,dxdy + 2\int_{-\infty}^{x_{i-1}}\int_{x_{i-1}}^{x_{i+1}} \ldots\,dxdy + + \int_{-\infty}^{x_{i-1}}\int_{x{i+1}}^{+\infty} \ldots\,dxdy 
	\\
	& +  \int_{-\infty}^{x_{i-1}}\int_{-\infty}^{x_{i-1}} \ldots\,dxdy := R_1 + R_2 + R_3 + R_4 + R_5 + R_6 + R_7.
\end{align*}

\begin{figure}[h]
\figinit{0.8pt}
% Axes
\figpt 1:(-100,0) \figpt 2:(200,0)
\figpt 11:(-90,-10) \figpt 12:(-90,140)
%%%%
\figpt 3:(-50,0) \figpt 4:(0,100) 
\figpt 5:(50,0) \figpt 6:(0,0)

\figpt 31:(-40,20) \figpt 41:(-30,40) 
\figpt 51:(-20,60) \figpt 61:(-10,80)

\figpt 32:(40,20) \figpt 42:(30,40) 
\figpt 52:(20,60) \figpt 62:(10,80)
%
% Points for writing
\figpt 7:(-50,-10) \figpt 8:(0,110) 
\figpt 9:(50,-10) \figpt 10:(0,-10)

\figpt 71:(-50,-40) \figpt 81:(50,110) 
\figpt 91:(50,-40) \figpt 101:(0,-40)

\figpt 72:(-50,-25) \figpt 82:(50,110) 
\figpt 92:(50,-25) \figpt 102:(0,-25)

\figpt 13:(-100,130) \figpt 14:(180,-10)
\figpt 15:(-50,50) \figpt 16:(80,50)

% 2. Creation of the graphical file
\figdrawbegin{}
\figdrawarrow[1,2]
\figset (color=\Redrgb)
\figdrawline[3,4]
\figdrawline[4,5]
\figset (width=default,color=default)
%\figdrawline[3,4]
%\figdrawline[4,5]
%\figset (color=default)
\figset(dash=4)
\figdrawline[4,6]
\figdrawline[41,61]
\figdrawarrow[11,12]

\figdrawend

% 3. Writing text on the figure
\figvisu{\figBoxA}{}{
\figwritec [7]{$(x_{i-1},0)$}
\figwritec [8]{$(x_i,1)=(x_j,1)$}
\figwritec [9]{$(x_{i+1},0)$}
\figwritec [10]{$(x_i,0)$}
\figwritec [71]{$(x_{j-1},0)$}
\figwritec [91]{$(x_{j+1},0)$}
\figwritec [101]{$(x_j,0)$}
\figwritec [72,92,102]{$\shortparallel$}
\figwritec [13]{$y$}
\figwritec [14]{$x$}
\figwritec [16]{$\phi_i(x)=\color{red}\phi_j(x)$}
\figset write(mark=$\figBullet$)
\figwritep[3,31,41,51,61,4,32,42,52,62,5]
}
\centerline{\box\figBoxA}
\caption{Basis functions $\phi_i(x)$ and $\phi_j(x)$. In this case, the two functions coincides}\label{basis_dia}
\end{figure}

Also in this case, the terms $R_i$, $i=1,\ldots,7$ will be computed separately, obtaining
\begin{align*}
	a_{i,i} = \begin{cases}
			\displaystyle h^{1-2s}\,\frac{2^{3-2s}-4}{s(1-2s)(1-s)(3-2s)}, & \displaystyle s\neq\frac{1}{2}
			\\
			\\
			8\ln 2, & \displaystyle s=\frac{1}{2}.			
			\end{cases}	
\end{align*}

\begin{remark}
We point out the following facts:
\begin{itemize}
	\item The matrix $\mathcal A_h$ has the structure of a $N$-diagonal matrix, meaning that value of its elements remain constant along its diagonals. This is in analogy with the tridiagonal matrix approximating the classical Laplace operator. Notice, however, that in our case we obtain a full matrix. This is consistent with the non-local nature of the operator that we are discretizing.
	
	\item The value of each element $a_{i,j}$ is given explicitly, in terms only of $i$, $j$, $s$ and $h$. In other words, when approximating the left hand side of \eqref{WFD}, no numerical integration is needed. This significantly improve the efficiency of our method.
	
	\item For $s=1/2$, the elements $a_{i,j}$ do not depend on the value of $h$ which, in turn, is a function of $N$. This implies that, in this particular case, no matter how many points we consider in our mesh, the matrix $\mathcal A_h$ will always have the same entries. 
\end{itemize}
\end{remark}

\subsection{Parabolic problem}

We now present the numerical implementation of the control problem for the fractional heat equation. Since we have obtained a FE approximation $\mathcal A_h$ of the operator $\fl{s}{}$, we can compute the fully-discrete approximation of \eqref{heat_frac}. For this purpose, for any $h>0$, let us introduce the Euclidean spaces $E_h$, with inner product $\langle\cdot,\cdot\rangle_h$ and norm $\norm{\cdot}{h}$, and $U_h$, with inner product $[\cdot,\cdot]_h$ and norm $\inter{\cdot}_h$. In this setting, \eqref{heat_frac} can be discretized through the implicit Euler method on $M-1$ time steps as
\begin{align}\label{frac_heat_num}
	\begin{cases}
		\displaystyle\mathcal M_h \frac{z^{n+1}-z^n}{\delta t}+\mathcal A_h z^{n+1}=\mathbf{1}_\omega v_h^{n+1}, \quad \forall n\in \left\{1,\ldots,M-1\right\}
		\\
		z^0=z_0, 
	\end{cases}
\end{align}
where $z_0\in E_h$, $\mathcal M_h$ is the classical mass matrix with entries $m_{i,j}=\langle \phi_i,\phi_j\rangle$ and $\delta t=T/M$. Hence, we are reduced to solve the minimization problem

\begin{align}\label{min_adj}
	\varphi_\varepsilon^T=\min_{\varphi^T\in L^2_{h,\delta t}(0,1)}J_\varepsilon(\varphi^T)
\end{align}
where
\begin{align*}
	J_\varepsilon(\varphi^T)=\frac{1}{2}\iint_{\omega\times(0,T)}|\varphi|^2dxdt+\frac{\varepsilon}{2}\|\varphi^T\|^2_{L^2_{h,\delta t}(0,1)}+\int_{0}^{1}\varphi^1y_0\,dx, \quad \forall \varphi^T\in L_{h,\delta t}^2(0,1)
\end{align*}
and $\varphi=(\varphi^n)_{1\leq n\leq M+1}$ is solution to the adjoint system
\begin{align}\label{frac_adj_num}
	\begin{cases}
		\displaystyle\mathcal M_h \frac{\varphi^n-\varphi^{n+1}}{\delta t}+\mathcal A_h \varphi^n=0, & \forall n\in\inter{1,M}
		\\
		\varphi^{M+1}=\varphi^T. 
	\end{cases}
\end{align}

By solving problem \eqref{min_adj}, and from duality theory, we obtain a control function
$v_\varepsilon=\mathbf{1}_\omega\varphi_\varepsilon$ where $\varphi_\epsilon$ is the solution to \eqref{frac_adj_num} evaluated in the optimal datum $\varphi_\varepsilon^T$. Studying the behaviour of the solution to the optimization problem with respect to $\varepsilon$, we can recover usual theoretical results for controllability of evolution equations. This will be supported by  the numerical experiments that we are going to resent in Section \ref{res_numerical}.




